---
title: 任意用户密码重置
date: 2019-05-09 10:04:47
tags: [知识点]
categories: 整理
---

# 任意用户密码重置姿势

## 0x00 前言

这里记录一些实战中碰到的一些任意密码重置的案例。

## 0x01 验证码暴力破解

这类是最常见的任意密码重置问题了。由于服务端没有对访问做限制，同时验证码过多而且生存周期较长，导致可以爆破处验证码，对任意用户账号进行重置。

在找回密码发送验证码后，填写任意验证码进行爆破。

![0x01_1](/img/Web/20190509/0x01_1.png)

爆破出验证码后即可重置密码

​	![0x01_2](/img/Web/20190509/0x01_2.png)

## 0x02 验证码被返回

### 验证码直接返回

最常见的一类是验证码直接被返回给前端。如下图所示：

![0x02_1_1](/img/Web/20190509/0x02_1_1.png)

填写返回的验证码。

![0x02_1_2](/img/Web/20190509/0x02_1_2.png)

### 验证码返回在Cookie中

![0x02_2_1](/img/Web/20190509/0x02_2_1.png)

发送验证码并抓取返回包。发现返回包中设置的Cookie存在phoneCode字段:885042，猜测为验证码。输入验证码重置。修改成功。

![0x02_2](/img/Web/20190509/0x02_2_2.png)

![0x02_3](/img/Web/20190509/0x02_2_3.png)

## 0x03 没有验证接受验证码的账号是否与被修改密码账号一致

下面案例先用账号接受验证码后，再请求包中修改邮箱为受害者邮箱。

![0x03_1](/img/Web/20190509/0x03_1.png)

成功修改密码。

![0x03_2](/img/Web/20190509/0x03_2.png)

## 0x04 跳过验证步骤

输入重置账号后，可跳过验证步骤，直接访问重置密码页面。

在第一步正常输入需要重置的账号。

![0x04_1](/img/Web/20190509/0x04_1.png)

在第二步直接访问重置密码的链接。retrievepasswordmobile.html

![0x04_2](/img/Web/20190509/0x04_2.png)

绕过验证码直接来到了重置密码的第三步。

![0x04_3](/img/Web/20190509/0x04_3.png)

重置密码。

![0x04_4](/img/Web/20190509/0x04_4.png)

## 0x05 修改验证邮箱

账户重置密码需要从邮箱获取验证，能够修改邮箱为自己的邮箱。

![0x05_1](/img/Web/20190509/0x05_1.png)

在数据包中将邮箱地址修改为自己的邮箱。

![0x05_2](/img/Web/20190509/0x05_2.png)

从邮箱中获取验证码后进入修改密码。

![0x05_3](/img/Web/20190509/0x05_3.png)

![0x05_4](/img/Web/20190509/0x05_4.png)

## 0x06 重置密码最后一步uid可控

重置密码最后一步uid可控，可以通过该参数重置任意账户密码

用已有账户接受验证码

![0x06_1](/img/Web/20190509/0x06_1.png)

最后一步修改请求包中可修改代表用户身份的uid，修改为任意用户uid。

![0x06_2](/img/Web/20190509/0x06_2.png)

最终自动跳转登陆。



